kind: Deploy
type: helm
name: cnpg-operator
disabled: "${environment.name != 'local'}"
spec:
  chart:
    name: cloudnative-pg
    repo: https://cloudnative-pg.github.io/charts
    version: "~0.21.0"
  namespace: cnpg-system
  # createNamespace: true
---
kind: Deploy
type: kubernetes
name: cnpg-database
disabled: "${environment.name != 'local'}"
spec:
  files:
    - manifests/cnpg.yaml
  namespace: ${environment.namespace} # Add explicit namespace
dependencies:
  - deploy.cnpg-operator  # Wait for operator to be ready
  - deploy.secrets