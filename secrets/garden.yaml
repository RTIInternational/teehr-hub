kind: Deploy
name: secrets
type: kubernetes
environments:
  - local
  - remote
spec:
  manifests:
    $forEach: ${var.secrets}
    $return:
      apiVersion: v1
      kind: Secret
      metadata:
        name: ${item.key}
      type: ${item.value.type || "Opaque"}
      stringData: ${item.value.data || item.value}
varfiles: 
  - secrets.${environment.name}.yaml
variables:
  secrets: {}
# ---
# kind: Deploy
# type: helm
# name: external-secrets
# spec:
#   chart:
#     name: external-secrets
#     repo: https://charts.external-secrets.io
#   values:
#     namespace: external-secrets
#     createNamespace: true
#     installCRDs: true
# environments:
#   - remote
# ---
# kind: Deploy
# name: aws-rds-secrets
# type: kubernetes
# spec:
#   files: ["./manifests/aws-rds-secrets.yaml"]
# environments:
#   - remote
# dependencies: [deploy.external-secrets]