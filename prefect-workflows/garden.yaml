kind: Build
type: container
name: teehr-prefect-image
description: Build TEEHR Prefect workflow deployer image
spec:
  dockerfile: Dockerfile.prefect-teehr
  buildArgs:
      TEEHR_VERSION: ${var.devTeehrVersion}
environments:
  - local
---
kind: Deploy
type: kubernetes
name: prefect-workflow-deploy
description: K8s Deploy Prefect Workflows
dependencies:
  - deploy.prefect-server
  - deploy.prefect-worker
  - build.teehr-prefect-image
  - build.teehr-spark-executor-image
environments:
  - local
spec:
  files: ["./manifests/prefect-deployer-job.yaml"]
---
kind: Deploy
type: kubernetes
name: update-job-template
description: Update job template
dependencies:
  - deploy.prefect-server
  - deploy.prefect-worker
  - build.teehr-prefect-image
environments:
  - local
spec:
  files: ["./manifests/update-job-template.yaml"]